const btnTestFeedbackSubmit=document.querySelector("#btnTestFeedbackSubmit"),btnStartTest=document.querySelector("#btnStartTest"),divInitiator=document.querySelector("#divInitiator"),testContent=document.querySelector("#testContent"),testTimer=document.querySelector("#divFloatTimer"),btnSubmitTest=document.querySelector("#btnSubmitTest"),optCheckInput=document.querySelectorAll(".opt-check-input");function testSubmit(){var e=document.querySelectorAll(".jq-hdnakq"),t=e.length;let n=0,r=0,s=0;e.forEach(function(e){var t=e.id.split("_");if(2==t.length)switch(processAnswer(e,t[1])){case 0:n++;break;case 1:r++;break;case 2:s++}});document.querySelectorAll(".bix-div-answer").forEach(function(e){makeVisible(e)});var e=document.querySelector("#divSubmitTest"),u=document.querySelector("#testFeedBackBox"),o=document.querySelector("#endOfTestLabel"),l=document.querySelector("#testResultStats"),i=document.querySelector("#testResultMark"),a=document.querySelector("#totalQues"),c=document.querySelector("#answeredQues"),d=document.querySelector("#unAnsweredQues"),m=document.querySelector("#divFloatTimer"),i=(i.innerHTML=r+"/"+t,a.innerHTML=t.toString(),c.innerHTML=(r+s).toString(),d.innerHTML=n.toString(),e.classList.add("d-none"),makeVisible(l),makeVisible(o),makeVisible(u),disableOption(),l.scrollIntoView({behavior:"smooth"}),clearInterval(_timerHandler),m.classList.add("d-none"),document.title="Test Result",parseInt(document.querySelector("#hdnInitTimer").value)),a=i-parseInt(document.querySelector("#hdnTimer").value);_txtTestStats={TotQ:t,AnsQ:r+s,UnAnsQ:n,CorAns:r,WrongAns:s,TotTime:i,TimeTaken:a}}function processAnswer(e,t){var n=document.querySelector("#userAnswer_"+t),r=document.querySelector("#tdOptionDt_"+e.value+"_"+t);return isNotNull(r)&&r.classList.add("correct-ans"),e.value!=n.value?/^[A-E]$/.test(n.value)?(r=document.querySelector("#tdOptionDt_"+n.value+"_"+t),isNotNull(r)?(r.classList.add("wrong-ans"),2):void 0):0:1}function disableOption(){document.querySelectorAll(".opt-check-input").forEach(function(e){e.disabled=!0})}isNotNull(btnStartTest)&&btnStartTest.addEventListener("click",()=>{_timerHandler=setInterval("MyTimer()",1e3),divInitiator.classList.add("d-none"),makeVisible(testContent),makeVisible(testTimer),window.onbeforeunload=function(e){return e.preventDefault(),"Are you sure you want to leave?"}}),optCheckInput.forEach(function(n){n.addEventListener("click",()=>{var e,t=n.value.split("_");3==t.length&&(e=document.getElementById("userAnswer_"+t[2]),document.getElementById("userAnswerLtr_"+t[2]).innerHTML='<span class="mdi mdi-alpha-'+t[1].toLowerCase()+'-circle-outline"></span>',e.value=t[1])})}),isNotNull(btnSubmitTest)&&btnSubmitTest.addEventListener("click",()=>{var e=document.querySelectorAll(".user-answer-val");let t=0;if(e.forEach(function(e){"F"==e.value&&t++}),txtUnAns="",0<t&&(txtUnAns="Note: "+t+" question(s) are not answered yet. \n\n"),!confirm(txtUnAns+"Are you sure you want to submit the Test now?"))return!1;testSubmit()}),isNotNull(btnTestFeedbackSubmit)&&btnTestFeedbackSubmit.addEventListener("click",e=>{e.preventDefault();var e=document.querySelector("#testFeedbackForm"),t=document.querySelector("#idQualityLevel"),n=document.querySelector("#idDifficultyLevel");let r=document.querySelector("#js_resp_test");var s=e.SubjectID.value,u=e.TestID.value,o=e.TestKey.value,l=e.TestHash.value,i=e.txtFullName.value.trim(),a=e.txtEmailID.value.trim(),c=e.txtTestComment.value.trim(),d=document.getElementById("anonymousPost").checked;if("0"==t.value)return r.innerHTML="Kindly select a Test Quality Level.",t.focus(),!1;if("0"==n.value)return r.innerHTML="Kindly select a Test Difficulty Level.",n.focus(),!1;if(c.length<5)return r.innerHTML="Kindly enter comment at-least 5 characters.",e.txtTestComment.focus(),!1;if((null==document.getElementById("hdn_host")||d)&&!/^[a-zA-Z]([ ]?[a-zA-Z.]){2,49}$/.test(i))return r.innerHTML=makeErrorHtml("The full name should be at least 3 characters long."),e.txtFullName.focus(),!1;e={type:"test-submit",subjectId:s,testId:u,qLevel:t.value,dLevel:n.value,testKey:o,testHash:l,testComment:c,testStats:_txtTestStats,fullName:i,url:window.location.href,isAnonymous:d,emailId:a};httpPostJsonAsync("/ajax/onlinetest",e=>{if(isJson(e)){e=JSON.parse(e);if("true"==e.status)return window.onbeforeunload=null,btnTestFeedbackSubmit.setAttribute("disabled","disabled"),!(r.innerHTML="<h6>Thanks for your feedback. Stay smart..!</h6>");r.innerHTML=e.html}return!1},e),r.innerHTML=_MSG_PLZ_WAIT});let _txtTestStats=Array(),_timerHandler=0;function MyTimer(){var e=document.querySelector("#hdnTimer"),t=e.value,n=document.querySelector("#idFloatTimerLCD");0<t?(hours=((t-=1)/3600).toString().split(".")[0],mins=(t%3600/60).toString().split(".")[0],secs=(t%3600%60).toString(),1==hours.length&&(hours="0"+hours),1==mins.length&&(mins="0"+mins),1==secs.length&&(secs="0"+secs),n.innerText=hours+":"+mins+":"+secs,e.value=t,document.title=n.innerText):(testSubmit(),alert(" Your time is up ! \n\n Let's see the Result & Statistics of the Test."))}